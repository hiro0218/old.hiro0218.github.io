window.onload=function(){var a=document.getElementById("editor"),b=document.getElementById("result"),c=document.getElementsByClassName("btn-save")[0],d=document.getElementsByClassName("btn-clear")[0],e=null,f=a.value;loadStorage(a);window.setInterval(function(){saveStorage(a)},6E4);marked.setOptions({langPrefix:"language-",breaks:!0});keyup(a,b);a.value&&keyup(a,b);a.addEventListener("focus",function(){window.clearInterval(e);e=window.setInterval(function(){var c=a.value;f!=a.value&&keyup(a,b);f=
c},1E3)},!1);a.addEventListener("blur",function(){keyup(a,b)},!1);monitoringKey(a);c.addEventListener("click",function(){confirm("Save?")&&(saveStorage(a),keyup(a,b))},!1);d.addEventListener("click",function(){confirm("Clear?")&&(a.value="",clearStorage(),keyup(a,b))},!1)};function keyup(a,b){var c=a.value,c=stripScriptTag(c);b.innerHTML=marked(c)}function stripScriptTag(a){for(var b=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;b.test(a);)a=a.replace(b,"");return a}
function monitoringKey(a){enableInsertTAB(a)}function enableInsertTAB(a){a.onkeydown=function(a){if(9===a.keyCode){a=this.value;var c=this.selectionStart,d=this.selectionEnd;this.value=a.substring(0,c)+"\t"+a.substring(d);this.selectionStart=this.selectionEnd=c+1;return!1}}}function saveStorage(a){localStorage.setItem("markunVal",a.value)}function loadStorage(a){a.innerHTML=localStorage.getItem("markunVal")}function clearStorage(){localStorage.removeItem("markunVal")};
